<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bot Initializer - Wipro</title>
    <script src="jquery-3.3.1.min.js"></script>
    <script src="CryptoJS.js"></script>
    <style>
        .pullcenter {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .folderPathInput{
            width: 100%;

        }
        .lableTD{
            width: 150px;
            text-align: center;
        }
        .lableTDheader{
            width: 150px;
            text-align: center;
            font-weight: bold;
        }
        table, td, th {
            border: 5px solid #007bb6;
        }
        /* The Modal (background) */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content/Box */
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 50%; /* Could be more or less, depending on screen size */
        }

        /* The Close Button */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        .modal-header {
            padding: 2px 16px;
            background-color: red;
            color: white;
        }

        .modal-body {padding: 2px 16px;}

        /* Add Animation */
        @-webkit-keyframes slideIn {
            from {bottom: -300px; opacity: 0}
            to {bottom: 0; opacity: 1}
        }

        @keyframes slideIn {
            from {bottom: -300px; opacity: 0}
            to {bottom: 0; opacity: 1}
        }

        @-webkit-keyframes fadeIn {
            from {opacity: 0}
            to {opacity: 1}
        }

        @keyframes fadeIn {
            from {opacity: 0}
            to {opacity: 1}
        }
    </style>
</head>
<body>
    <div>
        <h1 style="text-align: center;border-bottom: 1px solid black;padding-bottom: 40px;"><img src="WiproLogo" align="middle" style="float: left;"> Wipro RPA - AA Bot Initializer</h1>
    </div>
    <div id="loadXML">
        <h2 style="text-align: center">Enter you XML here</h2>
        <textarea class="pullcenter" rows="20" cols="150" id="ipXML"></textarea> <br><br>
        <img src="arrow_right.png" class="pullcenter" width="200" height="60" style="cursor: pointer" onclick="ActivateParseXML()">
    </div>
    <div id="parseXML">
        <table border="1" style="border-collapse: collapse" cellpadding="10" width="100%">
            <tbody>
                <tr>
                    <td class="lableTD">Input : </td>
                    <td> <input id="inputNode" class="folderPathInput"></td>
                    <td class="lableTD">Output : </td>
                    <td> <input id="outputNode" class="folderPathInput"></td>
                </tr>
                <tr>
                    <td class="lableTD">Temp : </td>
                    <td> <input id="tempNode" class="folderPathInput"></td>
                    <td class="lableTD">Template : </td>
                    <td> <input id="templateNode" class="folderPathInput"></td>
                </tr>
                <tr>
                    <td class="lableTD">MyDocs Root Folder Path : </td>
                    <td>
                        <input id="MyDocsNode" class="folderPathInput">
                    </td>
                    <td colspan="2" rowspan="2">
                        <table border="1" style="border-collapse: collapse" cellpadding="10" width="100%">
                            <tbody>
                            <tr>
                                <td class="lableTDheader">Transaction Log</td>
                                <td class="lableTD">Enable : </td>
                                <td>
                                    <select id="TransactionEnableAttr" onchange="TransactionLogEnableToggle()">
                                        <option value="True" selected>Yes</option>
                                        <option value="False">No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="lableTD">
                                    Log Path :
                                </td>
                                <td colspan="2">
                                    <input id="TransactionNode" class="folderPathInput">
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td class="lableTD">Logs Root Folder Path : </td>
                    <td>
                        <input id="LogsValueNode" class="folderPathInput">
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <table border="1" style="border-collapse: collapse" cellpadding="10" width="100%">
                            <tbody>
                                <tr>
                                   <td colspan="6" class="lableTDheader">Audit Log</td>
                                </tr>
                                <tr>
                                    <td class="lableTD">Enable : </td>
                                    <td>
                                        <select id="AuditEnableAttr" onchange="AuditLogEnableToggle()">
                                            <option value="True">Yes</option>
                                            <option value="False">No</option>
                                        </select>
                                    </td>
                                    <td class="lableTD">Auto - Clear Logs : </td>
                                    <td>
                                        <select id="AuditACLAttr" onchange="AuditACLToggle()">
                                            <option value="True">Yes</option>
                                            <option value="False">No</option>
                                        </select>
                                    </td>
                                    <td class="lableTD">Auto - Clear Interval : </td>
                                    <td><select class="0To500" id="AuditACLDaysAttr"></select></td>
                                </tr>
                                <tr>
                                    <td class="lableTD">
                                        Log Path :
                                    </td>
                                    <td colspan="5">
                                        <input id="AuditNode" class="folderPathInput">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td colspan="2">
                        <table border="1" style="border-collapse: collapse" cellpadding="10" width="100%">
                            <tbody>
                            <tr>
                                <td colspan="6" class="lableTDheader">Error Log</td>
                            </tr>
                            <tr>
                                <td class="lableTD">Enable : </td>
                                <td>
                                    <select disabled id="ErrorEnableAttr">
                                        <option value="True" selected>Yes</option>
                                        <option value="False">No</option>
                                    </select>
                                </td>
                                <td class="lableTD">Auto - Clear Logs : </td>
                                <td>
                                    <select id="ErrorACLAttr" onchange="ErrorACLToggle()">
                                        <option value="True">Yes</option>
                                        <option value="False">No</option>
                                    </select>
                                </td>
                                <td class="lableTD">Auto - Clear Interval : </td>
                                <td><select class="0To500" id="ErrorACLDaysAttr"></select></td>
                            </tr>
                            <tr>
                                <td class="lableTD">
                                    Log Path :
                                </td>
                                <td colspan="5">
                                    <input id="ErrorNode" class="folderPathInput">
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td class="lableTD">Current Execution Environment : </td>
                    <td>
                        <input type="radio" id="CurrExecEnvDevelopment" name="CurrExecEnv" value="Development"> Development
                        <input type="radio" id="CurrExecEnvUAT" name="CurrExecEnv" value="UAT"> UAT
                        <input type="radio" id="CurrExecEnvProduction" name="CurrExecEnv" value="Production"> Production
                    </td>
                    <td class="lableTD">Enable Debugging (Message Boxes) : </td>
                    <td>
                        <select id="DebugFlagNode">
                            <option value="True">Yes</option>
                            <option value="False">No</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <fieldset>
                            <legend>Applications Configured (Count : <span id="AppsConfiguredCount"></span>)</legend>
                            <p style="text-align: right"><button onclick="AddAppToGrid('','','','')"> + Add New App</button> </p>
                            <table border="1" style="border-collapse: collapse" cellpadding="10" width="100%">
                                <thead>
                                    <th>Application Name</th>
                                    <th>Development Path</th>
                                    <th>UAT Path</th>
                                    <th>Production Path</th>
                                    <th>Delete</th>
                                </thead>
                                <tbody id="AppsConfiguredBody">

                                </tbody>
                            </table>
                        </fieldset>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <fieldset>
                            <legend>Secured Credential Vault</legend>
                            <p >Search Credentials(Enter your key)
                                <input type="password" id="myPasscode" >
                                <button onclick="">Search</button>
                                <button style="float: right;" onclick="AddNewCredentials()"> + Add New Credentials</button> </p>
                            <table border="1" style="border-collapse: collapse" cellpadding="10" width="100%">
                                <thead>
                                <th>Application Name</th>
                                <th>Development Path</th>
                                <th>UAT Path</th>
                                <th>Production Path</th>
                                <th>Delete</th>
                                </thead>
                                <tbody id="AppsConfiguredBody">

                                </tbody>
                            </table>
                        </fieldset>
                    </td>
                </tr>
            </tbody>
        </table>
       <br><br>
        <img src="arrow_right.png" class="pullcenter" width="200" height="60" style="cursor: pointer" onclick="ActivateOutputXML()">
        <!-- The Credential Modal -->
        <div id="credentialModal" class="modal">

            <!-- Modal content -->
            <div class="modal-content">
                <div class="modal-header">
                    <span class="close" onclick="CloseCredentialModal()">&times;</span>
                    <h2>Secured Credential Vault Manager</h2>
                </div>
                <div class="modal-body" style="border: 1px solid red;padding: 10px;">
                    <table cellpadding="10">
                        <tbody>
                            <tr>
                                <td>
                                    Credential Name (Unique) :
                                </td>
                                <td>
                                    <input type="hidden" id="currentCredentialModalMode">
                                    <input type="text" id="credentialName">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    Credential Description :
                                </td>
                                <td>
                                    <input type="text" id="credentialDescription">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    Credential Secret Key :
                                </td>
                                <td>
                                    <input type="password" id="credentialSecretKey">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    Credential :
                                </td>
                                <td>
                                    <input type="password" id="credentialActual">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <button onclick="SaveCredentials()">Save Credential</button>
                                </td>
                                <td>
                                    &nbsp;
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <div id="outputXML">
        <h2 style="text-align: center">Your final output XML is ready below</h2>
        <textarea class="pullcenter" rows="20" cols="150" id="opXML"></textarea> <br>
        <h2 style="text-align: center">Please copy paste this in your target XML file</h2>
    </div>
<script type="application/javascript">
    var inputXML = "";
    var parser = new DOMParser();
    var xmlDoc;
    var AppsConfiguredCount = 0;

    $( document ).ready(function() {
        $("#loadXML").css("display","block");
        $("#parseXML").css("display","none");
        $("#outputXML").css("display","none");

        $(".0To500").each(function(index,value){
            for (i=0;i<=500;i++){
                $(value).append($('<option></option>').val(i).html(i))
            }
        });
    });

    function ActivateParseXML(){
        var inputXML = $("#ipXML").val();
        if(inputXML==""){
            alert("Input XML is empty! Please paste your XML and Proceed.");
            return;
        }
        xmlDoc = parser.parseFromString(inputXML,"text/xml");
        $("#inputNode").val(xmlDoc.getElementsByTagName("Input")[0].childNodes[0].nodeValue);
        $("#outputNode").val(xmlDoc.getElementsByTagName("Output")[0].childNodes[0].nodeValue);
        $("#tempNode").val(xmlDoc.getElementsByTagName("Temp")[0].childNodes[0].nodeValue);
        $("#templateNode").val(xmlDoc.getElementsByTagName("Template")[0].childNodes[0].nodeValue);
        $("#MyDocsNode").val(xmlDoc.getElementsByTagName("MyDocs")[0].childNodes[0].nodeValue);
        $("#AuditNode").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].childNodes[0].nodeValue);
        $("#ErrorNode").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Error")[0].childNodes[0].nodeValue);
        $("#AuditEnableAttr").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].getAttribute("enable"));
        $("#AuditACLAttr").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].getAttribute("autoClear"));
        $("#ErrorACLAttr").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Error")[0].getAttribute("autoClear"));
        $("#AuditACLDaysAttr").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].getAttribute("autoClearDays"));
        $("#ErrorACLDaysAttr").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Error")[0].getAttribute("autoClearDays"));
        $("#LogsValueNode").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("value")[0].childNodes[0].nodeValue);
        $("#TransactionNode").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Transaction")[0].childNodes[0].nodeValue);
        $("#TransactionEnableAttr").val(xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Transaction")[0].getAttribute("enable"));
        $("#DebugFlagNode").val(xmlDoc.getElementsByTagName("DebugFlag")[0].childNodes[0].nodeValue);

        if(xmlDoc.getElementsByTagName("CurrentExecutionEnvironment")[0].childNodes[0].nodeValue=="Development"){
            $("#CurrExecEnvDevelopment").prop("checked",true);
        } else if(xmlDoc.getElementsByTagName("CurrentExecutionEnvironment")[0].childNodes[0].nodeValue=="UAT") {
            $("#CurrExecEnvUAT").prop("checked",true);
        } else {
            $("#CurrExecEnvProduction").prop("checked",true);
        }

        for(i=0;i<=100;i++){
            if(xmlDoc.getElementsByTagName("Environment")[0].getElementsByTagName("Applications")[0].getElementsByTagName("App")[i] == undefined) break ;
            AddAppToGrid(xmlDoc.getElementsByTagName("Environment")[0].getElementsByTagName("Applications")[0].getElementsByTagName("App")[i].getAttribute("name"),xmlDoc.getElementsByTagName("Environment")[0].getElementsByTagName("Applications")[0].getElementsByTagName("App")[i].childNodes[0].nodeValue,xmlDoc.getElementsByTagName("Environment")[1].getElementsByTagName("Applications")[0].getElementsByTagName("App")[i].childNodes[0].nodeValue,xmlDoc.getElementsByTagName("Environment")[2].getElementsByTagName("Applications")[0].getElementsByTagName("App")[i].childNodes[0].nodeValue)
        }

        TransactionLogEnableToggle();
        AuditLogEnableToggle();
        ErrorACLToggle();

        $("#loadXML").css("display","none");
        $("#parseXML").css("display","block");
        $("#outputXML").css("display","none");
    }
    function ActivateOutputXML(){
        xmlDoc.getElementsByTagName("Input")[0].childNodes[0].nodeValue = $("#inputNode").val();
        xmlDoc.getElementsByTagName("Output")[0].childNodes[0].nodeValue = $("#outputNode").val();
        xmlDoc.getElementsByTagName("Temp")[0].childNodes[0].nodeValue = $("#tempNode").val();
        xmlDoc.getElementsByTagName("Template")[0].childNodes[0].nodeValue = $("#templateNode").val();
        xmlDoc.getElementsByTagName("MyDocs")[0].childNodes[0].nodeValue = $("#MyDocsNode").val();
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("value")[0].childNodes[0].nodeValue = $("#LogsValueNode").val();
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].childNodes[0].nodeValue = $("#AuditNode").val();
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].setAttribute("enable",$("#AuditEnableAttr").val());
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].setAttribute("autoClear",$("#AuditACLAttr").val());
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Audit")[0].setAttribute("autoClearDays",$("#AuditACLDaysAttr").val());
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Error")[0].childNodes[0].nodeValue = $("#ErrorNode").val();
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Error")[0].setAttribute("autoClear",$("#ErrorACLAttr").val());
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Error")[0].setAttribute("autoClearDays",$("#ErrorACLDaysAttr").val());
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Transaction")[0].childNodes[0].nodeValue = $("#TransactionNode").val();
        xmlDoc.getElementsByTagName("Logs")[0].getElementsByTagName("Transaction")[0].setAttribute("enable",$("#TransactionEnableAttr").val());
        xmlDoc.getElementsByTagName("DebugFlag")[0].childNodes[0].nodeValue = $("#DebugFlagNode").val();

        if($("#CurrExecEnvDevelopment").prop("checked")){
            xmlDoc.getElementsByTagName("CurrentExecutionEnvironment")[0].childNodes[0].nodeValue="Development";
        } else if ($("#CurrExecEnvUAT").prop("checked")){
            xmlDoc.getElementsByTagName("CurrentExecutionEnvironment")[0].childNodes[0].nodeValue="UAT";
        } else {
            xmlDoc.getElementsByTagName("CurrentExecutionEnvironment")[0].childNodes[0].nodeValue="Production";
        }

        for(i=0;i<=100;i++){
            if(xmlDoc.getElementsByTagName("Environment")[0].getElementsByTagName("Applications")[0].getElementsByTagName("App")[0] == undefined) break ;
            xmlDoc.getElementsByTagName("Environment")[0].getElementsByTagName("Applications")[0].getElementsByTagName("App")[0].remove();
            xmlDoc.getElementsByTagName("Environment")[1].getElementsByTagName("Applications")[0].getElementsByTagName("App")[0].remove();
            xmlDoc.getElementsByTagName("Environment")[2].getElementsByTagName("Applications")[0].getElementsByTagName("App")[0].remove();
        }

        for(i=0;i<$("#AppsConfiguredBody tr").length;i++){
            var devTag = xmlDoc.createElement("App");
            devTag.setAttribute("name",$("#AppsConfiguredBody tr")[i].getElementsByTagName("td")[0].getElementsByTagName("input")[0].value);
            devTag.appendChild(xmlDoc.createTextNode($("#AppsConfiguredBody tr")[i].getElementsByTagName("td")[1].getElementsByTagName("input")[0].value));

            var uatTag = xmlDoc.createElement("App");
            uatTag.setAttribute("name",$("#AppsConfiguredBody tr")[i].getElementsByTagName("td")[0].getElementsByTagName("input")[0].value);
            uatTag.appendChild(xmlDoc.createTextNode($("#AppsConfiguredBody tr")[i].getElementsByTagName("td")[2].getElementsByTagName("input")[0].value));

            var prodTag = xmlDoc.createElement("App");
            prodTag.setAttribute("name",$("#AppsConfiguredBody tr")[i].getElementsByTagName("td")[0].getElementsByTagName("input")[0].value);
            prodTag.appendChild(xmlDoc.createTextNode($("#AppsConfiguredBody tr")[i].getElementsByTagName("td")[3].getElementsByTagName("input")[0].value));

            xmlDoc.getElementsByTagName("Environment")[0].getElementsByTagName("Applications")[0].appendChild(devTag);
            xmlDoc.getElementsByTagName("Environment")[1].getElementsByTagName("Applications")[0].appendChild(uatTag);
            xmlDoc.getElementsByTagName("Environment")[2].getElementsByTagName("Applications")[0].appendChild(prodTag);
        }

        $("#loadXML").css("display","none");
        $("#parseXML").css("display","none");
        $("#outputXML").css("display","block");
        $("#opXML").val(new XMLSerializer().serializeToString(xmlDoc));
    }
    function TransactionLogEnableToggle(){
        if($("#TransactionEnableAttr").val() == "True"){
            $("#TransactionNode").prop("disabled", false);
        } else {
            $("#TransactionNode").prop("disabled", true);
        }
    }
    function AuditLogEnableToggle(){
        if($("#AuditEnableAttr").val() == "True"){
            $("#AuditACLAttr").prop("disabled", false);
            $("#AuditNode").prop("disabled", false);
            AuditACLToggle();
        } else {
            $("#AuditACLAttr").prop("disabled", true);
            $("#AuditACLDaysAttr").prop("disabled", true);
            $("#AuditNode").prop("disabled", true);
        }
    }
    function AuditACLToggle(){
        if($("#AuditACLAttr").val() == "True"){
            $("#AuditACLDaysAttr").prop("disabled", false);
        } else {
            $("#AuditACLDaysAttr").prop("disabled", true);
        }
    }
    function ErrorACLToggle(){
        if($("#ErrorACLAttr").val() == "True"){
            $("#ErrorACLDaysAttr").prop("disabled", false);
        } else {
            $("#ErrorACLDaysAttr").prop("disabled", true);
        }
    }
    function AddAppToGrid(AppName,DevPath,UATPath,ProdPath){
        var tmpTag = "<tr><td><input value='"+AppName+"' class='folderPathInput'></td><td><input value='"+DevPath+"' class='folderPathInput'></td><td><input value='"+UATPath+"' class='folderPathInput'></td><td><input value='"+ProdPath+"' class='folderPathInput'></td><td style='text-align: center'><button onclick='DeleteAppFromGrid(this)'>X</button> </td></tr>";
        $("#AppsConfiguredBody").html($("#AppsConfiguredBody").html()+tmpTag);
        AppsConfiguredCount++;
        $("#AppsConfiguredCount").html(AppsConfiguredCount);
    }
    function DeleteAppFromGrid(AppObj){
        AppObj.parentNode.parentNode.remove();
        AppsConfiguredCount--;
        $("#AppsConfiguredCount").html(AppsConfiguredCount);
    }
    function AddNewCredentials(){
        OpenCredentialModal();
        document.getElementById("currentCredentialModalMode").value = "Add";
        $("#credentialName").prop("disabled", false);
    }
    function UpdateCurrentCredentials(){
        OpenCredentialModal();
        document.getElementById("currentCredentialModalMode").value = "Update";
        $("#credentialName").prop("disabled", true);
    }
    function SaveCredentials(){
        if(document.getElementById("currentCredentialModalMode").value == "Add"){
            var credentialTag = xmlDoc.createElement("Credential");
            var credentialName = xmlDoc.createElement("CredentialName");
            credentialName.appendChild(xmlDoc.createTextNode($("#credentialName").val()));
            var credentialDescription = xmlDoc.createElement("CredentialDescription");
            credentialDescription.appendChild(xmlDoc.createTextNode($("#credentialDescription").val()));
            var credentialActual = xmlDoc.createElement("CredentialActual");
            credentialActual.appendChild(xmlDoc.createTextNode(CryptoJS.AES.encrypt($("#credentialActual").val(), $("#credentialSecretKey").val())));
            credentialTag.appendChild(credentialName);
            credentialTag.appendChild(credentialDescription);
            credentialTag.appendChild(credentialActual);
            xmlDoc.getElementsByTagName("Credentials")[0].appendChild(credentialTag);
        } else{

        }
        CloseCredentialModal();
    }
    function OpenCredentialModal(){
        document.getElementById('credentialModal').style.display = "block";
    }
    function CloseCredentialModal(){
        document.getElementById('credentialModal').style.display = "none";
    }
    window.onclick = function(event) {
        if (event.target == document.getElementById('credentialModal')) {
            document.getElementById('credentialModal').style.display = "none";
        }
    }

</script>
</body>
</html>